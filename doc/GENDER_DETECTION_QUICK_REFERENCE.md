# æ€§åˆ«è¯†åˆ«åŠŸèƒ½ - å¿«é€Ÿå‚è€ƒ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åœ¨ä¸»ç¨‹åºä¸­ä½¿ç”¨

```bash
python app_main.py
```

1. ç™»å½•åè¿›å…¥ä¸»çª—å£
2. å‹¾é€‰"å¯ç”¨æ€§åˆ«è¯†åˆ«"å¤é€‰æ¡†
3. é€‰æ‹©æ£€æµ‹ç®—æ³•ï¼ˆHaarã€YOLO11 æˆ– äººè„¸è·Ÿè¸ªï¼‰
4. ç‚¹å‡»"å¼€å§‹æ£€æµ‹"

### è¿è¡Œæµ‹è¯•è„šæœ¬

```bash
python test_gender_detection.py
```

é€‰æ‹©æµ‹è¯•æ¨¡å¼ï¼š
- 1: Haar + æ€§åˆ«è¯†åˆ«
- 2: YOLO11 + æ€§åˆ«è¯†åˆ«
- 3: äººè„¸è·Ÿè¸ª + æ€§åˆ«è¯†åˆ«
- 4: ç‹¬ç«‹æ€§åˆ«è¯†åˆ«å™¨

## ğŸ” è°ƒè¯•å·¥å…·

### æŸ¥çœ‹ç‰¹å¾å€¼

```bash
python debug_gender_features.py
```

é€‰æ‹©"å®æ—¶ç‰¹å¾è°ƒè¯•"ï¼ŒæŸ¥çœ‹ï¼š
- å®½é«˜æ¯”
- è¾¹ç¼˜å¯†åº¦
- çš®è‚¤æ¯”ä¾‹
- å¯¹æ¯”åº¦
- äº®åº¦
- çº¹ç†å¤æ‚åº¦

### åˆ†æé˜ˆå€¼

```bash
python debug_gender_features.py
```

é€‰æ‹©"é˜ˆå€¼åˆ†æ"ï¼Œæ”¶é›†æ ·æœ¬å¹¶è·å¾—ç»Ÿè®¡æ•°æ®ã€‚

## ğŸ¨ å¯è§†åŒ–è¯´æ˜

| é¢œè‰² | å«ä¹‰ |
|------|------|
| ğŸ”µ è“è‰² | ç”·æ€§ |
| ğŸ”´ çº¢è‰² | å¥³æ€§ |
| ğŸŸ¢ ç»¿è‰² | æœªçŸ¥ |

## ğŸ“Š ç‰¹å¾è¯´æ˜

### ç”·æ€§ç‰¹å¾
- âœ“ å®½é«˜æ¯” > 1.0ï¼ˆæ›´å®½ï¼‰
- âœ“ è¾¹ç¼˜å¯†åº¦é«˜ï¼ˆèƒ¡é¡»ã€æ£±è§’ï¼‰
- âœ“ çš®è‚¤æ¯”ä¾‹ä½ï¼ˆèƒ¡é¡»è¦†ç›–ï¼‰
- âœ“ å¯¹æ¯”åº¦é«˜ï¼ˆèƒ¡é¡»å¯¹æ¯”ï¼‰
- âœ“ äº®åº¦ä½ï¼ˆçš®è‚¤è¾ƒæš—ï¼‰
- âœ“ çº¹ç†å¤æ‚åº¦é«˜ï¼ˆèƒ¡é¡»çº¹ç†ï¼‰

### å¥³æ€§ç‰¹å¾
- âœ“ å®½é«˜æ¯” < 1.0ï¼ˆæ›´åœ†ï¼‰
- âœ“ è¾¹ç¼˜å¯†åº¦ä½ï¼ˆå…‰æ»‘ï¼‰
- âœ“ çš®è‚¤æ¯”ä¾‹é«˜ï¼ˆå‡åŒ€ï¼‰
- âœ“ å¯¹æ¯”åº¦ä½ï¼ˆå…‰æ»‘ï¼‰
- âœ“ äº®åº¦é«˜ï¼ˆçš®è‚¤è¾ƒäº®ï¼‰
- âœ“ çº¹ç†å¤æ‚åº¦ä½ï¼ˆå…‰æ»‘ï¼‰

## âš™ï¸ è°ƒæ•´é˜ˆå€¼

ç¼–è¾‘ `gender_detector.py` ä¸­çš„ `_detect_gender_simple` æ–¹æ³•ï¼š

```python
# é™ä½ä»¥æ›´å®¹æ˜“è¯†åˆ«ä¸ºç”·æ€§
if edge_density > 0.12:  # æ”¹ä¸º 0.10
    male_score += 0.3

if contrast > 35:  # æ”¹ä¸º 30
    male_score += 0.25

if texture_complexity > 15:  # æ”¹ä¸º 12
    male_score += 0.2
```

## ğŸ› å¸¸è§é—®é¢˜

### å…¨æ˜¯å¥³æ€§ï¼Ÿ
- âœ“ æ£€æŸ¥ç…§æ˜æ¡ä»¶ï¼ˆå¤ªäº®ä¼šå¯¼è‡´è¯¯åˆ¤ï¼‰
- âœ“ ç¡®ä¿äººè„¸å¤§å°åˆé€‚ï¼ˆ30-70% ç”»é¢ï¼‰
- âœ“ è¿è¡Œè°ƒè¯•å·¥å…·æŸ¥çœ‹ç‰¹å¾å€¼
- âœ“ è°ƒæ•´é˜ˆå€¼

### å…¨æ˜¯ç”·æ€§ï¼Ÿ
- âœ“ å¢åŠ ç…§æ˜äº®åº¦
- âœ“ è°ƒæ•´çš®è‚¤æ¯”ä¾‹é˜ˆå€¼ï¼ˆä» 0.5 æ”¹ä¸º 0.6ï¼‰
- âœ“ é™ä½å¯¹æ¯”åº¦é˜ˆå€¼

### ä¸ç¨³å®šï¼Ÿ
- âœ“ ä¿æŒç¨³å®šçš„ç…§æ˜
- âœ“ å¯¹å¤šå¸§ç»“æœè¿›è¡Œå¹³å‡
- âœ“ ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹

## ğŸ’» ä»£ç ç¤ºä¾‹

### åŸºç¡€ä½¿ç”¨

```python
from gender_detector import GenderDetector
from cv_test import HaarFaceDetector
import cv2

detector = HaarFaceDetector(enable_gender=True)
cap = cv2.VideoCapture(0)

while True:
    ret, frame = cap.read()
    detections = detector.detect_with_gender(frame)
    frame = detector.draw_detections_with_gender(frame, detections)
    cv2.imshow('Gender Detection', frame)
    if cv2.waitKey(1) & 0xFF == ord('q'):
        break

cap.release()
cv2.destroyAllWindows()
```

### ç‹¬ç«‹ä½¿ç”¨

```python
from gender_detector import GenderDetector
import cv2

gender_detector = GenderDetector(model_type='simple')
cap = cv2.VideoCapture(0)

while True:
    ret, frame = cap.read()
    # å‡è®¾å·²æ£€æµ‹åˆ°äººè„¸ (x1, y1, x2, y2)
    gender, conf = gender_detector.detect_gender(frame, (x1, y1, x2, y2))
    print(f"æ€§åˆ«: {gender}, ç½®ä¿¡åº¦: {conf:.2f}")
    if cv2.waitKey(1) & 0xFF == ord('q'):
        break

cap.release()
cv2.destroyAllWindows()
```

## ğŸ“ æ–‡ä»¶ç»“æ„

```
yoloface/
â”œâ”€â”€ gender_detector.py              # æ ¸å¿ƒæ¨¡å—
â”œâ”€â”€ test_gender_detection.py        # æµ‹è¯•è„šæœ¬
â”œâ”€â”€ debug_gender_features.py        # è°ƒè¯•å·¥å…·
â”œâ”€â”€ GENDER_DETECTION_GUIDE.md       # è¯¦ç»†æŒ‡å—
â”œâ”€â”€ GENDER_DETECTION_QUICK_REFERENCE.md  # æœ¬æ–‡ä»¶
â”œâ”€â”€ cv_test.py                      # Haar æ£€æµ‹å™¨ï¼ˆå·²å‡çº§ï¼‰
â”œâ”€â”€ yolo_test.py                    # YOLO11 æ£€æµ‹å™¨ï¼ˆå·²å‡çº§ï¼‰
â”œâ”€â”€ yolo_track.py                   # äººè„¸è·Ÿè¸ªå™¨ï¼ˆå·²å‡çº§ï¼‰
â””â”€â”€ app_main.py                     # ä¸»ç¨‹åºï¼ˆå·²å‡çº§ï¼‰
```

## ğŸ”§ æ”¯æŒçš„æ£€æµ‹å™¨

| æ£€æµ‹å™¨ | æ€§åˆ«è¯†åˆ« | è¯´æ˜ |
|--------|---------|------|
| Haar | âœ… | å¿«é€Ÿï¼Œå‡†ç¡®ç‡ 70-80% |
| YOLO11 | âœ… | ç²¾å‡†ï¼Œå‡†ç¡®ç‡ 75-85% |
| äººè„¸è·Ÿè¸ª | âœ… | è·Ÿè¸ª + æ€§åˆ«è¯†åˆ« |
| FastestV2 | âœ… | è½»é‡çº§ï¼Œéœ€æ‰‹åŠ¨é›†æˆ |

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

- **FPS**: ~30 FPSï¼ˆå–å†³äºäººè„¸æ•°é‡ï¼‰
- **å‡†ç¡®ç‡**: 70-85%ï¼ˆå–å†³äºæ¡ä»¶ï¼‰
- **å†…å­˜**: ä½ï¼ˆå¯å‘å¼æ–¹æ³•ï¼‰
- **å»¶è¿Ÿ**: < 50ms

## ğŸ¯ æœ€ä½³å®è·µ

1. **ç…§æ˜**: ä½¿ç”¨å‡åŒ€çš„ä¾§å…‰ç…§æ˜
2. **è·ç¦»**: ä¿æŒäººè„¸å ç”»é¢ 30-70%
3. **è§’åº¦**: æ­£é¢æˆ–ç•¥å¾®ä¾§é¢æœ€ä½³
4. **ç¨³å®šæ€§**: å¯¹å¤šå¸§ç»“æœè¿›è¡Œå¹³å‡
5. **è°ƒè¯•**: ä½¿ç”¨è°ƒè¯•å·¥å…·ä¼˜åŒ–é˜ˆå€¼

## ğŸ“ è·å–å¸®åŠ©

1. æŸ¥çœ‹è¯¦ç»†æŒ‡å—: `GENDER_DETECTION_GUIDE.md`
2. è¿è¡Œè°ƒè¯•å·¥å…·: `python debug_gender_features.py`
3. æŸ¥çœ‹æµ‹è¯•è„šæœ¬: `test_gender_detection.py`
4. æ£€æŸ¥æ—¥å¿—è¾“å‡º

---

**æœ€åæ›´æ–°**: 2025-12-10
**ç‰ˆæœ¬**: 1.0

